version: "2"
sql:
  - schema: 
      - "registry/operators/schema.sql"
    queries: "registry/operators/query.sql"
    engine: "postgresql"
    gen:
      go:
        package: "operators"
        out: "registry/operators"
        sql_package: "wpgx"
        emit_json_tags: true
        emit_exact_table_names: true
        overrides:
          - column: "operators.registered_at_block_number"
            go_type: "uint64"
          - column: "operators.registered_at_timestamp"
            go_type: "uint64"
          - column: "operators.active_epoch"
            go_type: "uint32"
          - column: "operators.exit_epoch"
            go_type: "uint32"
          - column: "operators.status"
            go_type:
              import: "github.com/galxe/spotted-network/pkg/common/types"
              package: "types"
              type: "OperatorStatus"
            
  - schema: 
      - "operator/tasks/schema.sql"
    queries: "operator/tasks/query.sql"
    engine: "postgresql"
    gen:
      go:
        package: "tasks"
        out: "operator/tasks"
        sql_package: "wpgx"
        emit_json_tags: true
        emit_exact_table_names: true
        overrides:
          # Column-specific mappings for tasks table
          - column: "tasks.required_confirmations"
            go_type: "uint16"
          - column: "tasks.retry_count"
            go_type: "uint16"
          - column: "tasks.chain_id"
            go_type: "uint32"
          - column: "tasks.block_number"
            go_type: "uint64"
          - column: "tasks.timestamp"
            go_type: "uint64"
          - column: "tasks.epoch"
            go_type: "uint32"
          - column: "tasks.status"
            go_type:
              import: "github.com/galxe/spotted-network/pkg/common/types"
              package: "types"
              type: "TaskStatus"
  
  - schema: 
      - "operator/task_responses/schema.sql"
      - "operator/tasks/schema.sql"
    queries: "operator/task_responses/query.sql"
    engine: "postgresql"
    gen:
      go:
        package: "task_responses"
        out: "operator/task_responses"
        sql_package: "wpgx"
        emit_json_tags: true
        emit_exact_table_names: true
        emit_empty_slices: true
        overrides:
          # Column-specific mappings for task_responses table
          - column: "task_responses.chain_id"
            go_type: "uint32"
          - column: "task_responses.epoch"
            go_type: "uint32"
          - column: "task_responses.block_number"
            go_type: "uint64"
          - column: "task_responses.timestamp"
            go_type: "uint64"


  - schema: 
      - "operator/consensus_responses/schema.sql"
      - "operator/tasks/schema.sql"
    queries: "operator/consensus_responses/query.sql"
    engine: "postgresql"
    gen:
      go:
        package: "consensus_responses"
        out: "operator/consensus_responses"
        sql_package: "wpgx"
        emit_json_tags: true
        emit_empty_slices: true
        overrides:
          - column: "consensus_responses.chain_id"
            go_type: "uint32"
          - column: "consensus_responses.block_number"
            go_type: "uint64"
          - column: "consensus_responses.epoch"
            go_type: "uint32"
  - schema: "operator/epoch_states/schema.sql"
    queries: "operator/epoch_states/query.sql"
    engine: "postgresql"
    gen:
      go:
        package: "epoch_states"
        out: "operator/epoch_states"
        sql_package: "wpgx"
        emit_json_tags: true
        emit_empty_slices: true
        overrides:
          - column: "epoch_states.epoch_number"
            go_type: "uint32"
          - column: "epoch_states.block_number"
            go_type: "uint64"

  # Add blacklist schema and queries
  - schema: 
      - "registry/blacklist/schema.sql"
    queries: "registry/blacklist/query.sql"
    engine: "postgresql"
    gen:
      go:
        package: "blacklist"
        out: "registry/blacklist"
        sql_package: "wpgx"
        emit_json_tags: true
        emit_exact_table_names: true
        emit_empty_slices: true